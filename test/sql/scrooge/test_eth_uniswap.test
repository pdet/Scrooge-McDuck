# name: test/sql/scrooge/test_eth_uniswap.test
# description: Test ETH scan ROI
# group: [scrooge]

require scrooge

statement ok
set eth_node_url= 'https://mempool.merkle.io/rpc/eth/pk_mbs_0b647b195065b3294a5254838a33d062';

query IIIIIIIIII
FROM read_eth(
    '0xBb2b8038a1640196FbE3e38816F3e67Cba72D940',
    'SYNC',
    20155765,
    20155765
)
limit 1
----
"0xbb2b8038a1640196fbe3e38816f3e67cba72d940"	Sync	"0x5004f54a265f2dde80254c7d972516280cf886f3348aa5616b869a03d24bdecd"	20155765	[10551363886, 1942679877456358670324]	177	false	[]	"0xe81b2289f41c1e397ca5f9d8be4534778a92a5186aa2032500f8b6e782d02990"	34

statement error
select data[1], data[2] FROM read_eth(
    'WBTK_WETH',
    'SYNC',
    20154992,
    20155831
)
----
Failed to infer the address

# WBTC and ETH pairing
query II
select data[1], data[2] FROM read_eth(
    '0xBb2b8038a1640196FbE3e38816F3e67Cba72D940',
    'SYNC',
    20154992,
    20155831
)
----
10565836168	1940010911013880876521
10565816952	1940014450056568835941
10565810494	1940015639556568835941
10565783345	1940020639556568835941
10564794691	1940202733214438415478
10558627962	1941339311449401968346
10558655111	1941334334745024700252
10554249412	1942147151681153011326
10553162954	1942347699350556225037
10551363886	1942679877456358670324
10551400278	1942673197213835942974
10551424347	1942668779049485225198
10551427731	1942668157875806339229

query II
select data[1], data[2] FROM read_eth(
    'WBTC_WETH',
    'SYNC',
    20154992,
    20155831
)
----
10565836168	1940010911013880876521
10565816952	1940014450056568835941
10565810494	1940015639556568835941
10565783345	1940020639556568835941
10564794691	1940202733214438415478
10558627962	1941339311449401968346
10558655111	1941334334745024700252
10554249412	1942147151681153011326
10553162954	1942347699350556225037
10551363886	1942679877456358670324
10551400278	1942673197213835942974
10551424347	1942668779049485225198
10551427731	1942668157875806339229